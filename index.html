<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Surebet Kalkulator Premium</title>
<style>
body {
    font-family: Arial, sans-serif;
    background-color: #000;
    color: #fff;
    margin: 0;
    padding: 20px;
}
h1 {
    text-align: center;
    color: #facc15;
    margin-bottom: 20px;
}
.container {
    max-width: 600px;
    margin: auto;
    background: #111;
    padding: 25px;
    border-radius: 15px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.6);
}
.button-group, .tax-buttons {
    display: flex;
    justify-content: center;
    gap: 5px;
    margin-bottom: 15px;
}
.button-group button, .tax-buttons button {
    flex: 1;
    padding: 12px;
    border: none;
    border-radius: 10px;
    font-weight: bold;
    cursor: pointer;
    transition: all 0.2s ease;
    opacity: 0.9;
}
.button-group button.yellow { background:#facc15; color:#000; }
.tax-buttons button.green { background: #16a34a; color: #fff; }
.tax-buttons button.red { background: #dc2626; color: #fff; }
.button-group button.active, .tax-buttons button.active {
    transform: scale(1.05);
    opacity: 1;
}
.button-group button:hover, .tax-buttons button:hover { transform: scale(1.05); opacity: 1; }
label { display:block; margin-top:10px; }
input { width:100%; padding:10px; margin-top:5px; border-radius:10px; border:none; background:#222; color:#fff; transition: all 0.2s ease;}
input::placeholder { color:#ccc; }
input:focus { box-shadow: 0 0 8px #facc15; outline:none; transform: scale(1.02); }
button#calculateBtn {
    width:100%; margin-top:20px;
    background:#facc15; color:#000;
    font-weight:bold; border-radius:10px; padding:12px;
    transition: all 0.2s ease;
}
button#calculateBtn:hover { background:#eab308; transform: scale(1.03); }

table { width:100%; border-collapse: collapse; margin-top:20px; background:#111; border-radius:10px; overflow:hidden; opacity:0; transform: translateY(-10px); transition: all 0.5s ease;}
table.show { opacity:1; transform: translateY(0); }
th, td { padding:10px; text-align:center; border-bottom:1px solid #333; }
th { background:#222; }

.history-title { margin-top:20px; font-size:18px; color:#facc15; cursor:pointer; user-select:none; text-align:center; transition: color 0.2s;}
.history-title:hover { color:#eab308; }
.history-container { display:none; margin-top:10px; opacity:0; transform: translateY(-10px); transition: all 0.5s ease;}
.history-container.show { opacity:1; transform: translateY(0);}
@media(max-width:500px){ .button-group button, .tax-buttons button { padding:8px; font-size:14px; } }
</style>
</head>
<body>
<div class="container">
<h1>Surebet Kalkulator Premium</h1>

<div class="button-group">
    <button id="btn2" class="yellow active">2 Bukmacherów</button>
    <button id="btn3" class="yellow">3 Bukmacherów</button>
</div>

<div id="eventsContainer"></div>

<label for="stake">Twoja stawka:</label>
<input type="number" id="stake" value="100" placeholder="Wpisz stawkę">

<button id="calculateBtn">Oblicz</button>

<div id="result"></div>

<div class="history-title" id="historyToggle">Historia ostatnich kalkulacji ▼</div>
<div class="history-container" id="historyContainer">
    <table id="historyTable">
        <thead>
            <tr>
                <th>Bukmacherzy</th>
                <th>Stawka</th>
                <th>Surebet %</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>
</div>
</div>

<script>
const eventsContainer = document.getElementById('eventsContainer');
const stakeInput = document.getElementById('stake');
const calculateBtn = document.getElementById('calculateBtn');
const resultDiv = document.getElementById('result');
const historyTableBody = document.querySelector('#historyTable tbody');
const historyToggle = document.getElementById('historyToggle');
const historyContainer = document.getElementById('historyContainer');

let numEvents = 2;
let taxes = [];

function createEventInputs(num) {
    eventsContainer.innerHTML = '';
    taxes = Array(num).fill(0);
    for (let i = 0; i < num; i++) {
        const div = document.createElement('div');
        div.innerHTML = `
            <label>Bukmacher ${i+1} - kurs:</label>
            <input type="number" step="0.01" class="odds" placeholder="Kurs">
            <div class="tax-buttons">
                <button class="green active" data-index="${i}" data-tax="0">Bez podatku</button>
                <button class="red" data-index="${i}" data-tax="0.12">Z podatkiem</button>
            </div>
        `;
        eventsContainer.appendChild(div);
    }

    const taxBtns = eventsContainer.querySelectorAll('.tax-buttons button');
    taxBtns.forEach(btn => {
        btn.addEventListener('click', () => {
            const index = parseInt(btn.dataset.index);
            taxes[index] = parseFloat(btn.dataset.tax);
            btn.parentNode.querySelectorAll('button').forEach(sib => sib.classList.remove('active'));
            btn.classList.add('active');
        });
    });
}

document.getElementById('btn2').addEventListener('click', () => { numEvents=2; createEventInputs(numEvents); document.getElementById('btn2').classList.add('active'); document.getElementById('btn3').classList.remove('active'); });
document.getElementById('btn3').addEventListener('click', () => { numEvents=3; createEventInputs(numEvents); document.getElementById('btn3').classList.add('active'); document.getElementById('btn2').classList.remove('active'); });

function loadHistory() {
    const history = JSON.parse(localStorage.getItem('surebetHistory') || '[]');
    historyTableBody.innerHTML = '';
    history.forEach(item => {
        const tr = document.createElement('tr');
        tr.innerHTML = `<td>${item.events.join(', ')}</td><td>${item.stake}</td><td>${item.surebet.toFixed(2)}%</td>`;
        historyTableBody.appendChild(tr);
    });
}

calculateBtn.addEventListener('click', () => {
    const oddsInputs = document.querySelectorAll('.odds');
    const odds = [];
    oddsInputs.forEach((input, i) => {
        let val = parseFloat(input.value);
        if (isNaN(val) || val<=0) val=0;
        odds.push(val*(1-taxes[i]));
    });

    const sumInverse = odds.reduce((acc,o)=>acc+1/o,0);
    const surebetPercent = sumInverse>0 ? (1-sumInverse)*100 :0;
    const stake = parseFloat(stakeInput.value);
    const stakesPerEvent = odds.map(o => stake/o/sumInverse);

    let html = `<h2 class="show">Wynik</h2>`;
    html += `<p class="show">Surebet: ${surebetPercent.toFixed(2)}%</p>`;
    html += '<table class="result-table show"><tr><th>Bukmacher</th><th>Kwota do postawienia</th></tr>';
    stakesPerEvent.forEach((s,i)=>html+=`<tr><td>Bukmacher ${i+1}</td><td>${s.toFixed(2)}</td></tr>`);
    html += '</table>';
    resultDiv.innerHTML = html;

    const eventsLabels = Array.from({length:odds.length},(_,i)=>`Bukmacher ${i+1}`);
    const history = JSON.parse(localStorage.getItem('surebetHistory')||'[]');
    history.unshift({events:eventsLabels,stake:stake,surebet:surebetPercent});
    if(history.length>10) history.pop();
    localStorage.setItem('surebetHistory',JSON.stringify(history));
    loadHistory();
});

historyToggle.addEventListener('click',()=>{
    historyContainer.classList.toggle('show');
    historyContainer.style.display = historyContainer.classList.contains('show') ? 'block' : 'none';
    historyToggle.textContent = historyContainer.classList.contains('show') ? 'Historia ostatnich kalkulacji ▲' : 'Historia ostatnich kalkulacji ▼';
});

createEventInputs(numEvents);
loadHistory();
</script>
</body>
</html>
